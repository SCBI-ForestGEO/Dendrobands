setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/data_entry_forms/2013")
# for biannual
#####
# for last biannual survey
data_2013 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/data_entry_forms/2013/scbi.dendroAll_2013.csv")
data_biannual <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/data_entry_forms/2013/data_entry_biannual_2013-16.csv")
names2013 <- c(colnames(data_2013))
namesbi <- c(colnames(data_biannual))
## find the names that are in data_2017 but not in data_biannual
missing <- setdiff(names2013, namesbi)
## add these missed names to data_biannual in order to combine to the master
data_biannual[missing] <- NA
data_biannual$area <- NULL #this column is only relevant for field
data_biannual$location <- NULL
test <- rbind(data_2013, data_biannual)
test <- test[order(test[,1], test[,3]),] #order by tag and survey.ID
## these values are constant from the previous survey.ID
library(zoo)
test$biannual <- na.locf(test$biannual)
test$intraannual <- na.locf(test$intraannual)
test$lx <- na.locf(test$lx)
test$ly <- na.locf(test$ly)
test$stemID <- na.locf(test$stemID)
test$treeID <- na.locf(test$treeID)
test$dbh <- na.locf(test$dbh)
#test$dendroID <- na.locf(test$dendroID)
test$type <- na.locf(test$type)
test$dendHt <- na.locf(test$dendHt)
## these values are not always constant
test$new.band <- ifelse(is.na(test$new.band), 0, test$new.band)
deadcodes <- c("D", "DS", "DC", "DN", "DT")
test$status <- as.character(test$status)
test$status <- ifelse((is.na(test$status))&(test$codes %in% deadcodes), "dead",
ifelse((is.na(test$status)), na.locf(test$status), test$status))
test$codes <- as.character(test$codes)
test$codes <- ifelse(is.na(test$codes), "", test$codes)
test$notes <- as.character(test$notes)
test$notes <- ifelse(is.na(test$notes), "", test$notes)
View(test)
## for fixing intraannual qualifier (do after last biannual merge)
test$intraannual <- ifelse(!(test$survey.ID %in% c("2013.01","2013.16")), "1", "0")
test$dendroID <- na.locf(test$dendroID)
write.csv(test, "scbi.dendroAll_2013.csv", row.names=FALSE)
x14 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/2014/scbi.dendroAll_2014.csv")
View(x14)
x13 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/2013/scbi.dendroAll_2013.csv")
View(x13)
dendro_trees <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/dendro_trees.csv")
View(dendro_trees)
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/data_entry_forms/2013")
## matching dbh and stemID/treeID
dendro14 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/2014/scbi.dendroAll_2014.csv")
dendro_trees <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/dendro_trees.csv")
View(dendro14)
dendro14$treeID <- dendro_trees$treeID[match(dendro14$tag, dendro_trees$tag)]
dendro14$stemID <- dendro_trees$stemID[match(dendro14$tag, dendro_trees$tag)]
write.csv(dendro14, "scbi.dendroAll_2014.csv", row.names=FALSE)
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/data_entry_forms/2014")
file_list <- list.files("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/data_entry_forms/2014", pattern="data_entry_intraannual")
# for intraannual
for (i in seq(along=file_list)){
filename = file_list[[i]]
data_2014 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/data_entry_forms/2014/scbi.dendroAll_2014.csv")
data_intra <- read.csv(filename)
names2014 <- c(colnames(data_2014))
namesintra <- c(colnames(data_intra))
## find the names that are in data_2018 but not in data_biannual
missing <- setdiff(names2014, namesintra)
## if need be, do the opposite
# missing <- setdiff(namesbi, names2018)
## add these missed names to data_biannual in order to combine to the master
data_intra[missing] <- NA
data_intra$area <- NULL #this column is only relevant for field
data_intra$location <- NULL #only for when merging data pre-2018
test <- rbind(data_2014, data_intra)
test <- test[order(test[,"tag"], test[,"survey.ID"]),] #order by tag and survey.ID
## these values are constant from the previous survey.ID
library(zoo)
test$biannual <- na.locf(test$biannual)
test$intraannual <- na.locf(test$intraannual)
test$lx <- na.locf(test$lx)
test$ly <- na.locf(test$ly)
test$stemID <- na.locf(test$stemID)
test$treeID <- na.locf(test$treeID)
test$dbh <- na.locf(test$dbh)
## these should be constant from previous survey, but obviously are updated whenever a new dendroband is installed
test$dendroID <- na.locf(test$dendroID)
test$type <- na.locf(test$type)
test$dendHt <- na.locf(test$dendHt)
## these values are not always constant
test$new.band <- ifelse(is.na(test$new.band), 0, test$new.band)
deadcodes <- c("D", "DS", "DC", "DN", "DT")
test$status <- as.character(test$status)
test$status <- ifelse((is.na(test$status))&(test$codes %in% deadcodes), "dead",
ifelse((is.na(test$status)), na.locf(test$status), test$status))
test$codes <- as.character(test$codes)
test$codes <- ifelse(is.na(test$codes), "", test$codes)
test$notes <- as.character(test$notes)
test$notes <- ifelse(is.na(test$notes), "", test$notes)
write.csv(test, "scbi.dendroAll_2013.csv", row.names=FALSE)
}
# for intraannual
for (i in seq(along=file_list)){
filename = file_list[[i]]
data_2014 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/data_entry_forms/2014/scbi.dendroAll_2014.csv")
data_intra <- read.csv(filename)
names2014 <- c(colnames(data_2014))
namesintra <- c(colnames(data_intra))
## find the names that are in data_2018 but not in data_biannual
missing <- setdiff(names2014, namesintra)
## if need be, do the opposite
# missing <- setdiff(namesbi, names2018)
## add these missed names to data_biannual in order to combine to the master
data_intra[missing] <- NA
data_intra$area <- NULL #this column is only relevant for field
data_intra$location <- NULL #only for when merging data pre-2018
test <- rbind(data_2014, data_intra)
test <- test[order(test[,"tag"], test[,"survey.ID"]),] #order by tag and survey.ID
## these values are constant from the previous survey.ID
library(zoo)
test$biannual <- na.locf(test$biannual)
test$intraannual <- na.locf(test$intraannual)
test$lx <- na.locf(test$lx)
test$ly <- na.locf(test$ly)
test$stemID <- na.locf(test$stemID)
test$treeID <- na.locf(test$treeID)
test$dbh <- na.locf(test$dbh)
## these should be constant from previous survey, but obviously are updated whenever a new dendroband is installed
test$dendroID <- na.locf(test$dendroID)
test$type <- na.locf(test$type)
test$dendHt <- na.locf(test$dendHt)
## these values are not always constant
test$new.band <- ifelse(is.na(test$new.band), 0, test$new.band)
deadcodes <- c("D", "DS", "DC", "DN", "DT")
test$status <- as.character(test$status)
test$status <- ifelse((is.na(test$status))&(test$codes %in% deadcodes), "dead",
ifelse((is.na(test$status)), na.locf(test$status), test$status))
test$codes <- as.character(test$codes)
test$codes <- ifelse(is.na(test$codes), "", test$codes)
test$notes <- as.character(test$notes)
test$notes <- ifelse(is.na(test$notes), "", test$notes)
write.csv(test, "scbi.dendroAll_2014.csv", row.names=FALSE)
}
View(data_2014)
# for biannual
#####
# for last biannual survey
data_2014 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/data_entry_forms/2014/scbi.dendroAll_2014.csv")
data_biannual <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/data_entry_forms/2014/data_entry_biannual_2014-14.csv")
names2014 <- c(colnames(data_2014))
namesbi <- c(colnames(data_biannual))
## find the names that are in data_2017 but not in data_biannual
missing <- setdiff(names2014, namesbi)
## add these missed names to data_biannual in order to combine to the master
data_biannual[missing] <- NA
data_biannual$area <- NULL #this column is only relevant for field
data_biannual$location <- NULL
test <- rbind(data_2014, data_biannual)
test <- test[order(test[,1], test[,3]),] #order by tag and survey.ID
## these values are constant from the previous survey.ID
library(zoo)
test$biannual <- na.locf(test$biannual)
test$intraannual <- na.locf(test$intraannual)
test$lx <- na.locf(test$lx)
test$ly <- na.locf(test$ly)
test$stemID <- na.locf(test$stemID)
test$treeID <- na.locf(test$treeID)
test$dbh <- na.locf(test$dbh)
#test$dendroID <- na.locf(test$dendroID)
test$type <- na.locf(test$type)
test$dendHt <- na.locf(test$dendHt)
## these values are not always constant
test$new.band <- ifelse(is.na(test$new.band), 0, test$new.band)
deadcodes <- c("D", "DS", "DC", "DN", "DT")
test$status <- as.character(test$status)
test$status <- ifelse((is.na(test$status))&(test$codes %in% deadcodes), "dead",
ifelse((is.na(test$status)), na.locf(test$status), test$status))
test$codes <- as.character(test$codes)
test$codes <- ifelse(is.na(test$codes), "", test$codes)
test$notes <- as.character(test$notes)
test$notes <- ifelse(is.na(test$notes), "", test$notes)
View(data_2014)
View(test)
## for fixing intraannual qualifier (do after last biannual merge)
test$intraannual <- ifelse(!(test$survey.ID %in% c("2014.01","2014.14")), "1", "0")
test$dendroID <- na.locf(test$dendroID)
write.csv(test, "scbi.dendroAll_2014.csv", row.names=FALSE)
dendro12 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/2012/scbi.dendroAll_2012.csv")
View(dendro12)
dendro12$intraannual <- ifelse(!(dendro12$survey.ID %in% c("2014.01","2014.14")), "1", "0")
dendro12$intraannual <- ifelse(!(dendro12$survey.ID %in% c("2012.01","2012.18")), "1", "0")
which(dendro12$intraannual == "1")-1
which()
View(dendro12)
"1" <- dendro12[which(dendro12$intraannual == "1")-1, "intraannual"]
1 <- dendro12[which(dendro12$intraannual == "1")-1, "intraannual"]
"1" <- dendro12[which(dendro12$intraannual == "1")-1, "intraannual"]
dendro12$intraannual <- as.character(dendro12$intraannual)
"1" <- dendro12[which(dendro12$intraannual == "1")-1, "intraannual"]
dendro12 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/2012/scbi.dendroAll_2012.csv")
View(dendro12)
dendro12$intraannual <- ifelse(!(dendro12$survey.ID %in% c("2012.01","2012.18")), "1", "0")
"1" <- dendro12[which(dendro12$intraannual == "1")-1, "intraannual"]
"1" <- dendro12[which(dendro12$intraannual == "1")-1, dendro12$intraannual]
"1" <- dendro12[which(dendro12$intraannual == "1")-1, 6]
dendro12$intraannual <- dendro12[which(dendro12$intraannual == "1")-1] +1
dendro12$intraannual <- dendro12[which(dendro12$intraannual == "1")-1, "intraannual"] +1
"1" -> dendro12[which(dendro12$intraannual == "1")-1, "intraannual"]
View(dendro12)
"1" -> dendro12[which(dendro12$intraannual == "1")+1, "intraannual"]
getwd()
write.csv(dendro12, "scbi.dendroAll_2012.csv", row.names=FALSE)
dendro13 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/2013/scbi.dendroAll_2013.csv")
View(dendro13)
"1" -> dendro13[which(dendro13$intraannual == "1")-1, "intraannual"]
"1" -> dendro13[which(dendro13$intraannual == "1")+1, "intraannual"]
getwd()
write.csv(dendro13, "scbi.dendroAll_2013.csv", row.names=FALSE)
dendro13 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/2013/scbi.dendroAll_2013.csv")
View(dendro13)
"1" -> dendro13[which(dendro13$intraannual == "1")-1, "intraannual"]
"1" -> dendro13[which(dendro13$intraannual == "1")+1, "intraannual"]
"1" -> dendro13[170,6]
dendro13$intraannual = 1
dendro13$intraannual <- ifelse(!(dendro13$survey.ID %in% c("2013.01","2013.18")), "1", "0")
"1" -> dendro13[which(dendro13$intraannual == "1")-1, "intraannual"]
"1" -> dendro13[which(dendro13$intraannual == "1")+1, "intraannual"]
View(dendro13)
dendro13 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/2013/scbi.dendroAll_2013.csv")
dendro13$intraannual <- ifelse(!(dendro13$survey.ID %in% c("2013.01","2013.18")), "1", "0")
"1" -> dendro13[which(dendro13$intraannual == "1")-1, "intraannual"]
"1" -> dendro13[which(dendro13$intraannual == "1")+1, "intraannual"]
View(dendro13)
dendro13$intraannual <- ifelse(!(dendro13$survey.ID %in% c("2013.01","2013.18")), "1", "0")
dendro13$intraannual <- ifelse(!(dendro13$survey.ID %in% c("2013.01","2013.16")), "1", "0")
"1" -> dendro13[which(dendro13$intraannual == "1")-1, "intraannual"]
"1" -> dendro13[which(dendro13$intraannual == "1")+1, "intraannual"]
"1" -> dendro13[124,6]
"1" -> dendro13[125,6]
"1" -> dendro13[170,6]
write.csv(dendro13, "scbi.dendroAll_2013.csv", row.names=FALSE)
dendro14 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/2014/scbi.dendroAll_2014.csv")
View(dendro14)
"1" -> dendro14[which(dendro14$intraannual == "1")-1, "intraannual"]
"1" -> dendro14[which(dendro14$intraannual == "1")+1, "intraannual"]
write.csv(dendro14, "scbi.dendroAll_2014.csv", row.names=FALSE)
