setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/blank_data_forms")
scbi.dendroAll_2018 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/clean_data_files/2018/scbi.dendroAll_2018.csv")
View(scbi.dendroAll_2018)
scbi.dendroAll_2018 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/clean_data_files/2018/scbi.dendroAll_2018.csv")
View(scbi.dendroAll_2018)
data_2018 <- scbi.dendroAll_2018
prevmeasin <- subset(data_2018,survey.ID=="2018.01" & intraannual=="1") #subset by previous survey.ID
data_intra <- subset(data_2018,survey.ID=="2018.01" & intraannual=="1") #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:12,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$"Date: SurveyID: Collector:" = NA
data_intra$"Date: SurveyID: Collector:" = NA
data_intra$"Date: SurveyID: Collector:" = NA
library(dplyr)
data_intra<-data_intra %>% rename("Date:  SurveyID:   Collector:" = measure, "codes&notes" = codes)
data_intra$prevmeas = prevmeasin$measure
data_intra[is.na(data_intra)&!is.na(data_intra$prevmeas)] <- " "
data_intra<-data_intra[,c(1:3,10,4:6,14,7,11:13,8:9)]
data_intra$location<-gsub("South", "S", data_intra$location)
data_intra$location<-gsub("North", "N", data_intra$location)
matrix <- function(data_intra, table_title) {
rbind(c(table_title, rep('', ncol(data_intra)-1)), # title
names(data_intra), # column names
unname(sapply(data_intra, as.character))) # data
}
temp <- matrix(data_intra, table_title=('Intraannual Survey'))
library(xlsx)
write.xlsx(temp, "field_form_intraannual.xlsx")
View(temp)
write.xlsx(temp, "field_form_intraannual.xlsx", row.names=FALSE, col.names=FALSE)
prevmeasin <- subset(data_2018,survey.ID=="2018.01" & intraannual=="1") #subset by previous survey.ID
data_intra <- subset(data_2018,survey.ID=="2018.01" & intraannual=="1") #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:12,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$"Date2: SurveyID: Name:" = NA
data_intra$"Date3: SurveyID: Name:" = NA
data_intra$"Date4: SurveyID: Name:" = NA
library(dplyr)
data_intra<-data_intra %>% rename("Date1:  SurveyID:   Name:" = measure, "codes&notes" = codes)
data_intra$prevmeas = prevmeasin$measure
data_intra[is.na(data_intra)&!is.na(data_intra$prevmeas)] <- " "
data_intra<-data_intra[,c(1:3,10,4:6,14,7,11:13,8:9)]
data_intra$location<-gsub("South", "S", data_intra$location)
data_intra$location<-gsub("North", "N", data_intra$location)
matrix <- function(data_intra, table_title) {
rbind(c(table_title, rep('', ncol(data_intra)-1)), # title
names(data_intra), # column names
unname(sapply(data_intra, as.character))) # data
}
temp <- matrix(data_intra, table_title=('Intraannual Survey'))
library(xlsx)
write.xlsx(temp, "field_form_intraannual.xlsx", row.names=FALSE, col.names=FALSE)
write.xlsx(temp, "field_form_intraannual.xlsx", row.names=FALSE, col.names=FALSE)
data_intra <- subset(data_2018,survey.ID=="2018.01" & intraannual=="1") #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:12,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$"Date2: SvID: Name:" = NA
data_intra$"Date3: SvID: Name:" = NA
data_intra$"Date4: SvID: Name:" = NA
data_intra$"Date5: SvID: Name:" = NA
library(dplyr)
data_intra<-data_intra %>% rename("Date1:  SvID:   Name:" = measure, "codes&notes" = codes, "stem" = stemtag)
data_intra$prevmeas = prevmeasin$measure
data_intra[is.na(data_intra)&!is.na(data_intra$prevmeas)] <- " "
View(data_intra)
data_intra<-data_intra[,c(1:3,10,4:6,15,7,11:14,8:9)]
data_2018 <- read.csv("scbi.dendroAll_2018.csv")
scbi.dendroAll_2018 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/clean_data_files/2018/scbi.dendroAll_2018.csv")
View(scbi.dendroAll_2018)
data_2018 <- read.csv("scbi.dendroAll_2018.csv")
data_2018 <- scbi.dendroAll_2018
prevmeasbi <- subset(data_2018,survey.ID=="2018.01" & biannual=="1") #subset by previous survey.ID
data_bi <- subset(data_2018,survey.ID=="2018.01" & biannual=="1") #subset by 2018.01 (one entry per stem)
data_bi<-data_bi[ ,c(1,2,7:12,15,22)]
data_bi$measure = NA
data_bi$codes = NA
data_bi$"Fall Collector:  "= NA
library(dplyr)
data_bi<-data_bi %>% rename("Spring Collector:" = measure, "codes&notes" = codes, "stem" = stemtag)
data_bi$prevmeas = prevmeasbi$measure
data_bi[is.na(data_bi)&!is.na(data_bi$prevmeas)] <- " "
data_bi<-data_bi[,c(1:3,10,4:6,12,7,11,8:9)]
data_bi$location<-gsub("South", "S", data_bi$location)
data_bi$location<-gsub("North", "N", data_bi$location)
matrix <- function(data_bi, table_title) {
rbind(c(table_title, rep('', ncol(data_bi)-1)), # title
names(data_bi), # column names
unname(sapply(data_bi, as.character))) # data
}
temp <- matrix(data_bi, table_title=('Biannual Survey            SpringDate:                       SpringSurveyID:                             FallDate:                       FallSurveyID:'))
library(xlsx)
write.xlsx(temp, "field_form_biannual.xlsx") #we write the file to .xlsx to more easily change print settings and cell dimensions
write.xlsx(temp, "field_form_biannual.xlsx", row.names=FALSE, col.names=FALSE) #we write the file to .xlsx to more easily change print settings and cell dimensions
