setwd("C:\Users\mcgregori\Dropbox (Smithsonian)\Github_Ian\Dendrobands\resources\field_forms")
dendro18 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/scbi.dendroAll_2018.csv")
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/field_forms")
View(dendro18)
recensus2018 <- read.csv("I:/recensus2018.csv")
View(recensus2018)
##subset by RD codes (having subset by 2018.14 already above)
data_install<-dendro18[which(dendro18$survey.ID=='2018.14'), ] #if did not do step 1a above then run this line before going on
data_install<-data_install[grepl("RD",data_install[["codes"]]), ]
View(data_install)
data_install$dbh <- recensus2018$DBH[match(data_install$tag, recensus2018$tag)] #when get the full 2018 data, the $tag should be changed to $stemID
View(data_install)
data_install<-dendro18[which(dendro18$survey.ID=='2018.14'), ] #if did not do step 1a above then run this line before going on
data_install<-data_install[grepl("RD",data_install[["codes"]]), ]
View(data_install)
data_install<-data_install[ ,c("tag", "stemtag", "sp", "quadrat", "lx", "ly", "dbh", "measure", "codes", "location", "dendDiam", "dendroID", "type", "dendHt")]
data_install$measure = NA
data_install$codes = NA
data_install$dendDiam = NA
data_install$dendHt = NA
data_install$type = NA
data_install$dendroID = NA
data_install$install.date = NA
data_install$dbhnew = NA
library(dplyr)
setnames(data_install, old=c("codes", "stemtag"), new=c("codes&notes", "stem"))
library(data.table)
setnames(data_install, old=c("codes", "stemtag"), new=c("codes&notes", "stem"))
data_install[is.na(data_install)] <- " "
View(data_install)
data_install<-data_install[,c(1:7,15,16,12,13,11,14,8:10)]
data_install$location<-gsub("South", "S", data_install$location)
data_install$location<-gsub("North", "N", data_install$location)
getwd()
matrix <- function(data_install, table_title) {
rbind(c(table_title, rep('', ncol(data_install)-1)), # title
names(data_install), # column names
unname(sapply(data_install, as.character))) # data
}
temp <- matrix(data_install, table_title=('Dendroband Replacement                       Date:                       Surveyors:'))
library(xlsx)
write.xlsx(temp, "field_form_bandreplace.xlsx", row.names = FALSE, col.names=FALSE)
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data")
band18 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/scbi.dendroAll_2018.csv")
library(chron)
band18$doy <- paste0(band18$month, sep="/", band18$day, sep="/", band18$year)
intra <- subset(band18, band18$intraannual == 1)
tagsintra <- c(unique(intra$tag))
surveys <- c(unique(intra$survey.ID))
intraannual <- split(intra, f=c(intra$tag))
intra$doy <- as.Date(intra$doy, format="%m/%d/%Y")
library(ggplot2)
View(intraannual)
names(intraannual)
View(intraannual[["10671"]])
test <- subset(intra, intra$tag == 10671)
p <- ggplot(test) +
aes(x = doy, y = measure) +
geom_line(color = "#0c4c8a") +
labs(title = paste0("Dendroband Growth 2018 ", i),
x = "Date 2018",
y = "Caliper measurements") +
theme_minimal()
p <- ggplot(test) +
aes(x = doy, y = measure) +
geom_line(color = "#0c4c8a") +
labs(title = paste0("Dendroband Growth 2018 ", "_10671"),
x = "Date 2018",
y = "Caliper measurements") +
theme_minimal()
View(p)
print(p)
pdf(file = "Dendrobands_2018.pdf")
for (i in names(intraannual)){
dendro <- intraannual[[i]]
ggplot(data = dendro) +
aes(x = doy, y = measure) +
geom_line(color = "#0c4c8a") +
labs(title = paste0("Dendroband Growth 2018 ",sep="_", i),
x = "Date 2018",
y = "Caliper measurements") +
theme_minimal()
print(list(dendro))
}
dev.off()
getwd()
View(dendro)
library(esquisse)
esquisse:::esquisser()
pdf(file = "Dendrobands_2018.pdf")
for (i in names(intraannual)){
dendro <- intraannual[[i]]
q <- ggplot(data = dendro) +
aes(x = doy, y = measure) +
geom_line(color = "#0c4c8a") +
labs(title = paste0("Dendroband Growth 2018 ",sep="_", i),
x = "Date 2018",
y = "Caliper measurements") +
theme_minimal()
print(q)
}
pdf(file = "Dendrobands_2018.pdf")
for (i in names(intraannual)){
dendro <- intraannual[[i]]
q <- ggplot(data = dendro) +
aes(x = doy, y = measure, group=1) +
geom_line(color = "#0c4c8a") +
labs(title = paste0("Dendroband Growth 2018 ",sep="_", i),
x = "Date 2018",
y = "Caliper measurements") +
theme_minimal()
print(q)
}
dev.off()
View(intraannual[["40569"]])
?facet_wrap
for (i in names(intraannual)){
dendro <- intraannual[[i]]
q <- ggplot(data = dendro) +
aes(x = doy, y = measure, group=1) +
geom_line(color = "#0c4c8a") +
labs(title = paste0("Dendroband Growth 2018 ",sep="_", i),
x = "Date 2018",
y = "Caliper measurements") +
theme_minimal() +
facet_wrap(c("tag", "stemtag"))
print(q)
}
print(q)
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data")
band18 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/scbi.dendroAll_2018.csv")
library(chron)
band18$doy <- paste0(band18$month, sep="/", band18$day, sep="/", band18$year)
intra <- subset(band18, band18$intraannual == 1)
tagsintra <- c(unique(intra$tag))
surveys <- c(unique(intra$survey.ID))
intra$doy <- as.Date(intra$doy, format="%m/%d/%Y")
intra$doy <- factor(intra$doy, ordered=TRUE)
intraannual <- split(intra, f=c(intra$tag))
intraannual <- split(intra, f=c(intra$tag,intra$stemtag))
View(intraannual)
intraannual <- split(intra, f=c(intra$tag))
library(ggplot2)
pdf(file = "Dendrobands_2018.pdf")
for (i in names(intraannual)){
dendro <- intraannual[[i]]
q <- ggplot(data = dendro) +
aes(x = doy, y = measure, group=1) +
geom_line(color = "#0c4c8a") +
labs(title = paste0("Dendroband Growth 2018 ",sep="_", i),
x = "Date 2018",
y = "Caliper measurements") +
theme_minimal() +
facet_wrap(c("tag", "stemtag"))
print(q)
}
dev.off()
View(intraannual[["60569"]])
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/results/dendro_trees_dbhcount")
data_2017 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/2017/scbi.dendroAll_2017.csv")
#subset by the last survey from the year
data_surveys<- subset(data_2017,data_2017$survey.ID=='2017.12') #& data_2017$status=='alive') #get rid of '0' values for minimum
data_trees <- data_2017[!duplicated(data_2017["sp"]),]
data_trees <- data_trees[c("sp")] #list that shows all sp alive and dead
#make data.frames with the dbhmax,min,mean by sp
data_surveys$dbh <- as.numeric(data_surveys$dbh)
dbhmax <- aggregate(data_surveys$dbh, by=list(data_surveys$sp), max)
dbhmin <- aggregate(data_surveys$dbh, by=list(data_surveys$sp), min)
dbhavg <- aggregate(data_surveys$dbh, by=list(data_surveys$sp), mean)
names(dbhmax) <- c("sp", "dbhmax.mm")
names(dbhmin) <- c("sp", "dbhmin.mm")
names(dbhavg) <- c("sp", "dbhavg.mm")
is.num <- sapply(dbhavg,is.numeric)
dbhavg[is.num] <- lapply(dbhavg[is.num], round, 1)
#create data.frame with count of sp per survey
library(data.table)
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/results/dendro_trees_dbhcount")
data_2017 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/scbi.dendroAll_2017.csv")
#subset by the last survey from the year
data_surveys<- subset(data_2017,data_2017$survey.ID=='2017.12') #& data_2017$status=='alive') #get rid of '0' values for minimum
data_trees <- data_2017[!duplicated(data_2017["sp"]),]
data_trees <- data_trees[c("sp")] #list that shows all sp alive and dead
#make data.frames with the dbhmax,min,mean by sp
data_surveys$dbh <- as.numeric(data_surveys$dbh)
dbhmax <- aggregate(data_surveys$dbh, by=list(data_surveys$sp), max)
dbhmin <- aggregate(data_surveys$dbh, by=list(data_surveys$sp), min)
dbhavg <- aggregate(data_surveys$dbh, by=list(data_surveys$sp), mean)
names(dbhmax) <- c("sp", "dbhmax.mm")
names(dbhmin) <- c("sp", "dbhmin.mm")
names(dbhavg) <- c("sp", "dbhavg.mm")
is.num <- sapply(dbhavg,is.numeric)
dbhavg[is.num] <- lapply(dbhavg[is.num], round, 1)
#create data.frame with count of sp per survey
library(data.table)
data_01<-subset(data_2017,data_2017$survey.ID=='2017.01') #get all sp
View(data_01)
countbi<- addmargins(table(data_01$sp, data_01$biannual),1)
countbi<- as.data.frame.matrix(countbi)
setDT(countbi, keep.rownames=TRUE)[]
colnames(countbi) <- c("sp", "biannual.n")
?addmargins
#create data.frame with count of sp per survey
library(data.table)
data_01<-subset(data_2017,data_2017$survey.ID=='2017.01') #get all sp
countbi<- addmargins(table(data_01$sp, data_01$biannual),"test")
View(countbi)
etwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/results/dendro_trees_dbhcount")
data_2017 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/scbi.dendroAll_2017.csv")
View(data_2017)
#subset by the last survey from the year
data_surveys<- subset(data_2017,data_2017$survey.ID=='2017.12') #& data_2017$status=='alive') #get rid of '0' values for minimum
data_trees <- data_2017[!duplicated(data_2017["sp"]),]
data_trees <- data_trees[c("sp")] #list that shows all sp alive and dead
View(data_trees)
#make data.frames with the dbhmax,min,mean by sp
data_surveys$dbh <- as.numeric(data_surveys$dbh)
View(data_surveys)
dbhmax <- aggregate(data_surveys$dbh, by=list(data_surveys$sp), max)
dbhmin <- aggregate(data_surveys$dbh, by=list(data_surveys$sp), min)
dbhavg <- aggregate(data_surveys$dbh, by=list(data_surveys$sp), mean)
View(dbhavg)
names(dbhmax) <- c("sp", "dbhmax.mm")
names(dbhmin) <- c("sp", "dbhmin.mm")
names(dbhavg) <- c("sp", "dbhavg.mm")
is.num <- sapply(dbhavg,is.numeric)
View(dbhavg)
dbhavg[is.num] <- lapply(dbhavg[is.num], round, 1)
View(dbhavg)
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/resources/field_forms")
dendro18 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/scbi.dendroAll_2018.csv")
##subset by RD codes (having subset by 2018.14 already above)
data_install<-dendro18[which(dendro18$survey.ID=='2018.14'), ] #if did not do step 1a above then run this line before going on
data_install<-data_install[grepl("RD",data_install[["codes"]]), ]
View(data_install)
premade <- c(10642,10682,32498,33331,50187,52186,52190,80148,101250,102503,110001,112115,121274,121360,140875,152423,152624,180731,182425,182460,191121,201191,202939)
premade %in% dendro18$tag
test$premade <- premade
test <- NULL
test$premade <- premade
test$match <- premade%in% dendro18$tag
View(test)
test$dbh <- dendro18$dbh[match(test$premade, dendro18$tag)]
data.frame(test)
test <- data.frame(test)
View(test)
dendro_trees <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/dendro_trees.csv")
premade%in% dendro_trees
premade %in% dendro_trees
dendro_trees %in% premade
recensus2018 <- read.csv("I:/recensus2018.csv")
View(recensus2018)
oldbands <- subset(recensus2018, premade %in% recensus2018$Tag)
View(oldbands)
oldbands <- subset(recensus2018, recensus2018$Tag %in% premade)
View(oldbands)
