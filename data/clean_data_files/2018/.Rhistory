data_2018 <- read.csv("data_2018.csv")
data_install<-data_2018[which(data_2018$survey.ID=='2018.01'), ]
#when trouble-shooting code, remove: &data_2018$codes=='RD'
#subset by RD codes and one entry per stem
data_install<-data_install[ ,c(1:2,7:13,15,21,26)]
data_install$measure = NA
data_install$codes = NA
data_install$notes = NA
data_install$dendDiam = NA
data_install$dendHt = NA
data_install$installdate = NA
data_install$surveyor = NA
data_install$dbhnew = NA
data_install<-data_install[,c(1:6,13,15,12,11,7:9,14,10)]
data_install$location<-gsub("South", "S", data_install$location)
data_install$location<-gsub("North", "N", data_install$location)
data_install<-sapply(data_install, as.character)
data_install[is.na(data_install)] <- " "
matrix <- function(data_install, table_title) {
rbind(c(table_title, rep('', ncol(data_install)-1)), # title
names(data_install), # column names
unname(sapply(data_install, as.character))) # data
}
temp <- matrix(data_install, table_title=('Dendroband Replacement        Date:'))
library(xlsx)
write.xlsx(temp, "data_entry_bandreplace.xlsx", row.names = FALSE)
data_2018 <- read.csv("data_2018.csv")
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/clean_data_files/2018")
data_2018 <- read.csv("data_2018.csv")
data_install<-data_2018[which(data_2018$survey.ID=='2018.01'), ]
#when trouble-shooting code, remove: &data_2018$codes=='RD'
#subset by RD codes and one entry per stem
data_install<-data_install[ ,c(1:2,7:13,15,21,26)]
data_install$measure = NA
data_install$codes = NA
data_install$notes = NA
data_install$dendDiam = NA
data_install$dendHt = NA
data_install$installdate = NA
data_install$surveyor = NA
data_install$dbhnew = NA
data_install<-data_install[,c(1:6,13,15,12,11,7:9,14,10)]
data_install$location<-gsub("South", "S", data_install$location)
data_install$location<-gsub("North", "N", data_install$location)
data_install<-sapply(data_install, as.character)
data_install[is.na(data_install)] <- " "
matrix <- function(data_install, table_title) {
rbind(c(table_title, rep('', ncol(data_install)-1)), # title
names(data_install), # column names
unname(sapply(data_install, as.character))) # data
}
temp <- matrix(data_install, table_title=('Dendroband Replacement        Date:'))
library(xlsx)
write.xlsx(temp, "data_entry_bandreplace.xlsx", row.names = FALSE)
