setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/clean_data_files/2018")
library(expss)
data_2018 <- read.csv("data_2018.csv")
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra<-data_intra[,c(1:3,11,4:10)]
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
table<-as.data.table(data_intra)
library(xtable)
View(table)
xtable<-xtable(data_intra)
View(xtable)
print(xtable)
print(xtable, include.rownames=TRUE, booktabs=TRUE)
xtableview<-print(xtable, include.rownames=TRUE, booktabs=TRUE)
view(xtableview)
print(xtable(data_intra, caption='Intraannual Survey'), caption.placement='top')
print(table(data_intra, caption='Intraannual Survey'), caption.placement='top')
print(xtable(data_intra, caption='Intraannual Survey'), caption.placement='top', type="html", file="testtable.html")
View(data_intra)
data_intra<-`[.noquote`(data_intra,c(1:7,8,8,8,8,8,9:11))
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra<-data_intra[,c(1:3,11,4:10)]
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
n=5
data_intra = cbind(data_intra,replicate(n,data_intra$measure))
View(data_intra)
data_intra = cbind(data_intra,replicate(n,data_intra$measure))
data_intra<-cbind(data_intra,replicate(5,data_intra$measure))
data_intra<-cbind(data_intra,replicate(5,"measure"))
View(data_intra)
?replicate
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra<-data_intra[,c(1:3,11,4:10)]
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
View(data_intra)
data_intra$col12 = data_intra$col8
rm(n)
rm(xtableview)
data_intra$col12 = data_intra$col8
data_intra$col12 <- data_intra$col8
library(dplyr)
data_intra <- data_intra %>% mutate(column_12=column8)
data_intra <- cbind(data_intra, data_intra[,8])
View(data_intra)
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/clean_data_files/2018")
data_2018 <- read.csv("data_2018.csv")
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra<-data_intra[,c(1:3,11,4:10)]
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
data_intra$col12 = data_intra$col8
data_intra <- cbind(data_intra, data_intra[,8])
View(data_intra)
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra$measure1 = NA
data_intra$measure2 = NA
data_intra$measure3 = NA
data_intra$measure4 = NA
View(data_intra)
data_intra<-data_intra[,c(1:3,11,4:10, 12:15)]
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
View(data_intra)
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra$measure1 = NA
data_intra$measure2 = NA
data_intra$measure3 = NA
data_intra$measure4 = NA
View(data_intra)
data_intra<-data_intra[,c(1:3,11,4:7,12:15,8:10)]
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
View(data_intra)
library(dplyr)
data_intra %>% rename("Collector: Measure:" = measure)
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra$measure1 = NA
data_intra$measure2 = NA
data_intra$measure3 = NA
data_intra$measure4 = NA
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra$measure1 = NA
data_intra$measure2 = NA
data_intra$measure3 = NA
data_intra$measure4 = NA
library(dplyr)
data_intra %>% rename("Collector: Measure:" = measure)
View(data_intra)
data_intra<-data_intra %>% rename("Collector: Measure:" = measure)
View(data_intra)
data_intra<-data_intra %>% rename("Collector: Measure:" = measure, "Collector: Measure:" = measure1, "Collector: Measure:" = measure2, "Collector: Measure:" = measure3, "Collector: Measure:" = measure4)
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
data_intra<-data_intra[,c(1:3,11,4:7,12:15,8:10)]
View(data_intra)
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra$measure1 = NA
data_intra$measure2 = NA
data_intra$measure3 = NA
data_intra$measure4 = NA
library(dplyr)
data_intra<-data_intra %>% rename("Collector: Measure:" = measure, "Collector: Measure:" = measure1, "Collector: Measure:" = measure2, "Collector: Measure:" = measure3, "Collector: Measure:" = measure4)
View(data_intra)
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
data_intra<-data_intra[,c(1:3,11,4:7,12:15,8:10)]
View(data_intra)
View(data_2018)
prevmeas <- data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by previous survey.ID
View(prevmeas)
prevmeas <- data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by previous survey.ID
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra$measure1 = NA
data_intra$measure2 = NA
data_intra$measure3 = NA
data_intra$measure4 = NA
library(dplyr)
data_intra<-data_intra %>% rename("Collector: Measure:" = measure, "Collector: Measure:" = measure1, "Collector: Measure:" = measure2, "Collector: Measure:" = measure3, "Collector: Measure:" = measure4)
data_intra$prevmeas = prevmeas$measure
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
data_intra<-data_intra[,c(1:3,11,4:7,12:15,8:10)]
View(data_intra)
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra$measure1 = NA
data_intra$measure2 = NA
data_intra$measure3 = NA
data_intra$measure4 = NA
library(dplyr)
data_intra<-data_intra %>% rename("Collector: Measure:" = measure, "Collector: Measure:" = measure1, "Collector: Measure:" = measure2, "Collector: Measure:" = measure3, "Collector: Measure:" = measure4)
data_intra$prevmeas = prevmeas$measure
View(data_intra)
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
data_intra<-data_intra[,c(1:3,11,4:7,16,12:15,8:10)]
View(data_intra)
data_intra<-data_intra[,c(1:3,11,16,4:7,12:15,8:10)]
View(data_intra)
data_intra<-data_intra[,c(1:3,11,4:7,16,12:15,8:10)]
View(prevmeas)
View(data_intra)
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra$measure1 = NA
data_intra$measure2 = NA
data_intra$measure3 = NA
data_intra$measure4 = NA
library(dplyr)
data_intra<-data_intra %>% rename("Collector: Measure:" = measure, "Collector: Measure:" = measure1, "Collector: Measure:" = measure2, "Collector: Measure:" = measure3, "Collector: Measure:" = measure4)
data_intra$prevmeas = prevmeas$measure
View(data_intra)
data_intra<-data_intra[,c(1:3,11,4:6,16,7,12:15,8:10)]
View(data_intra)
data_intra<-sapply(data_intra, as.character)
data_intra[is.na(data_intra)] <- " "
View(data_intra)
data_intra[is.na(data_intra)&!is.na(data_intra$prevmeas)] <- " "
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra$measure1 = NA
data_intra$measure2 = NA
data_intra$measure3 = NA
data_intra$measure4 = NA
library(dplyr)
data_intra<-data_intra %>% rename("Collector: Measure:" = measure, "Collector: Measure:" = measure1, "Collector: Measure:" = measure2, "Collector: Measure:" = measure3, "Collector: Measure:" = measure4)
data_intra$prevmeas = prevmeas$measure
data_intra<-data_intra[,c(1:3,11,4:6,16,7,12:15,8:10)]
data_intra[is.na(data_intra)&!is.na(data_intra$prevmeas)] <- " "
View(data_intra)
?is.na
data_intra[is.na(data_intra)&!is.na(data_intra$prevmeas)] <- " "
View(data_intra)
data_intra[!is.na(data_intra$prevmeas)&is.na(data_intra)] <- " "
View(data_intra)
View(prevmeas)
data_intra<-data_intra %>% rename("Collector: Measure:" = measure, "Collector: Measure:" = measure1, "Collector: Measure:" = measure2, "Collector: Measure:" = measure3, "Collector: Measure:" = measure4)
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra$measure1 = NA
data_intra$measure2 = NA
data_intra$measure3 = NA
data_intra$measure4 = NA
library(dplyr)
data_intra<-data_intra %>% rename("Collector: Measure:" = measure, "Collector: Measure:" = measure1, "Collector: Measure:" = measure2, "Collector: Measure:" = measure3, "Collector: Measure:" = measure4)
View(data_intra)
data_intra$prevmeas = prevmeas$measure
data_intra<-data_intra[,c(1:3,11,4:6,16,7,12:15,8:10)]
data_intra[is.na(data_intra)&!is.na(data_intra$prevmeas)] <- " "
View(data_intra)
data_intra<-data_2018[which(data_2018$survey.ID=='2018.01' & data_2018$intraannual=='1'), ] #subset by 2018.01 (one entry per stem)
data_intra<-data_intra[ ,c(1,2,7:13,15,22)]
data_intra$measure = NA
data_intra$codes = NA
data_intra$notes = NA
data_intra$measure1 = NA
data_intra$measure2 = NA
data_intra$measure3 = NA
data_intra$measure4 = NA
library(dplyr)
data_intra<-data_intra %>% rename("Collector: Measure:" = measure, "Collector: Measure:" = measure1, "Collector: Measure:" = measure2, "Collector: Measure:" = measure3, "Collector: Measure:" = measure4)
data_intra$prevmeas = prevmeas$measure
data_intra[is.na(data_intra)&!is.na(data_intra$prevmeas)] <- " "
data_intra<-data_intra[,c(1:3,11,4:6,16,7,12:15,8:10)]
View(data_intra)
?text_matrix
text_matrix <- function(data_intra_intra, table_title) {
rbind(c(table_title, rep('', ncol(data_intra)-1)), # title
rep('', ncol(data_intra)), # blank spacer row
names(data_intra), # column names
unname(sapply(data_intra, as.character))) # data_intra
}
temp <- text_matrix(data_intra, table_title=('Intraannual Survey Date: SurveyID:'))
write.table(temp, 'test.csv', row.names=F, col.names=F, sep=',')
text_matrix <- function(data_intra_intra, table_title) {
rbind(c(table_title, rep('', ncol(data_intra)-1)), # title
names(data_intra), # column names
unname(sapply(data_intra, as.character))) # data_intra
}
temp <- text_matrix(data_intra, table_title=('Intraannual Survey Date: SurveyID:'))
write.table(temp, 'test.csv', row.names=F, col.names=F, sep=',')
write.table(temp, 'test.csv', row.names=F, col.names=F, sep=',')
?rep
text_matrix <- function(data_intra_intra, table_title) {
rbind(c(table_title, rep('', ncol(data_intra)-1)), # title
rep('', ncol(data_intra)), # blank spacer row
names(data_intra), # column names
unname(sapply(data_intra, as.character))) # data
}
temp <- text_matrix(data_intra, table_title=('Intraannual Survey         Date:                SurveyID:'))
write.table(temp, 'test.xlsx', row.names=F, col.names=F, sep=',')
write.table(temp, 'test.xls', row.names=F, col.names=F, sep=',')
write.table(temp, 'test.csv', row.names=F, col.names=F, sep=',')
text_matrix <- function(data_intra_intra, table_title) {
rbind(c(table_title, rep('', ncol(data_intra)-1)), # title
names(data_intra), # column names
unname(sapply(data_intra, as.character))) # data
}
temp <- text_matrix(data_intra, table_title=('Intraannual Survey         Date:                SurveyID:'))
write.table(temp, 'test.csv', row.names=F, col.names=F, sep=',')
write.table(temp, 'test.csv', row.names=F, col.names=F, sep=',')
View(text_matrix)
install.packages("xlsx")
library(xlsx)
?xlsx
xlsx
View(temp)
write.xlsx(temp, "test.xlsx")
library(xlsx)
install.packages("JavaGD")
install.packages("rJava")
library(xlsx)
install.packages("rJava",,"http://rforge.net/",type="source")
library(xlsx)
