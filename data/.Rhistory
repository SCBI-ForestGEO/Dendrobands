survey$biannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead$stemID)), survey$biannual.dead)
dead_intra <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID) & file$intraannual == 1, ]
survey$intraannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead_intra$stemID)), survey$intraannual.dead)
#___.added
new <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]], ]
survey$biannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new$stemID)), survey$biannual.added)
new_intra <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]] & dendro_trees$intraannual == 1, ]
survey$intraannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new_intra$stemID)), survey$intraannual.added)
}
View(survey)
View(alive)
if (year == 2013){
alive <- file[file$status == alive & file$survey.ID == 2013.06, ]
}
else {
alive <- file[file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
}
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$status == alive & file$survey.ID == 2013.06, ]
}
else {
alive <- file[file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
}
year == 2013
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$status == alive & file$survey.ID == 2013.06, ]
} else {
alive <- file[file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
}
for (k in seq(along=dirs)){
path <- dirs[[k]]
file <- read.csv(path, stringsAsFactors = FALSE)
for (i in seq(along=survey$year[1:9])){
year <- survey$year[[i]]
if (k==i){
#n.surveys
survey$n.surveys <- ifelse(survey$year %in% survey$year[[i]], length(unique(file$survey.ID)), survey$n.surveys)
#__.all
all_bi <- dendro_trees[!dendro_trees$dendro.start.year > year, ]
survey$biannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_bi$stemID)), survey$biannual.all)
all_intra <- all_bi[all_bi$intraannual == 1, ]
survey$intraannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_intra$stemID)), survey$intraannual.all)
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$status == alive & file$survey.ID == 2013.06, ]
} else {
alive <- file[file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
}
survey$biannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive$stemID)), survey$biannual.live)
alive_intra <- file[file$intraannual == 1 & file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
survey$intraannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive_intra$stemID)), survey$intraannual.live)
#___.dead
dead <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID), ]
survey$biannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead$stemID)), survey$biannual.dead)
dead_intra <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID) & file$intraannual == 1, ]
survey$intraannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead_intra$stemID)), survey$intraannual.dead)
#___.added
new <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]], ]
survey$biannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new$stemID)), survey$biannual.added)
new_intra <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]] & dendro_trees$intraannual == 1, ]
survey$intraannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new_intra$stemID)), survey$intraannual.added)
}
View(survey)
i=4
k=4
path <- dirs[[k]]
file <- read.csv(path, stringsAsFactors = FALSE)
year <- survey$year[[i]]
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$status == alive & file$survey.ID == 2013.06, ]
} else {
alive <- file[file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
}
View(alive)
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$status == "alive" & file$survey.ID == 2013.06, ]
} else {
alive <- file[file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
}
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$survey.ID == max(file$survey.ID), ]
} else {
alive <- file[file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
}
for (k in seq(along=dirs)){
path <- dirs[[k]]
file <- read.csv(path, stringsAsFactors = FALSE)
for (i in seq(along=survey$year[1:9])){
year <- survey$year[[i]]
if (k==i){
#n.surveys
survey$n.surveys <- ifelse(survey$year %in% survey$year[[i]], length(unique(file$survey.ID)), survey$n.surveys)
#__.all
all_bi <- dendro_trees[!dendro_trees$dendro.start.year > year, ]
survey$biannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_bi$stemID)), survey$biannual.all)
all_intra <- all_bi[all_bi$intraannual == 1, ]
survey$intraannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_intra$stemID)), survey$intraannual.all)
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$survey.ID == max(file$survey.ID), ]
#because 2013 new plants added in middle of season
} else {
alive <- file[file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
}
survey$biannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive$stemID)), survey$biannual.live)
alive_intra <- file[file$intraannual == 1 & file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
survey$intraannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive_intra$stemID)), survey$intraannual.live)
#___.dead
dead <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID), ]
survey$biannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead$stemID)), survey$biannual.dead)
dead_intra <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID) & file$intraannual == 1, ]
survey$intraannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead_intra$stemID)), survey$intraannual.dead)
#___.added
new <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]], ]
survey$biannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new$stemID)), survey$biannual.added)
new_intra <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]] & dendro_trees$intraannual == 1, ]
survey$intraannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new_intra$stemID)), survey$intraannual.added)
}
View(survey)
scbi.stem2 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/SCBI-ForestGEO-Data/tree_main_census/data/census-csv-files/scbi.stem2.csv", stringsAsFactors=FALSE)
View(scbi.stem2)
alive <- scbi.stem2[scbi.stem2$status == "alive"]
alive <- scbi.stem2[scbi.stem2$status == "alive", ]
alive <- scbi.stem2[scbi.stem2$DFstatus == "alive", ]
library(fgeo)
?autoplot_by_species
pdf("test.pdf", width=10)
for (i in seq(along=alive$sp)){
test <- alive$sp[[i]]
change <- alive[alive$sp %in% test]
q <- autoplot(sp_elev(change, elevation))
}
for (i in seq(along=alive$sp)){
test <- alive$sp[[i]]
change <- alive[alive$sp %in% test, ]
q <- autoplot(sp_elev(change, elevation))
}
View(change)
?autoplot
for (i in seq(along=alive$sp)){
test <- alive$sp[[i]]
change <- alive[alive$sp %in% test, ]
q <- autoplot(sp_elev(change))
}
dev.off()
change <- alive[alive$sp %in% "acne", ]
q <- autoplot(sp_elev(change))
print(q)
q <- autoplot(sp_elev(change, elevation))
print(q)
q <- autoplot(sp_elev(change, elev))
print(q)
q <- autoplot(sp_elev(change, elev()))
print(q)
q <- autoplot(sp_elev(change, elev(elev))
print(q)
}
dev.off()
change <- alive[alive$sp %in% "acne", ]
q <- autoplot(sp_elev(change, elev(elev))
print(q)
}
dev.off()
change <- alive[alive$sp %in% "acne", ]
q <- autoplot(sp_elev(change))
print(q)
update.packages("fgeo")
?update.packages
devtools::update_packages("fgeo")
scbi.stem2 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/SCBI-ForestGEO-Data/tree_main_census/data/census-csv-files/scbi.stem2.csv", stringsAsFactors=FALSE)
alive <- scbi.stem2[scbi.stem2$DFstatus == "alive", ]
library(fgeo)
pdf("test.pdf", width=10)
change <- alive[alive$sp %in% "acne", ]
q <- autoplot(sp_elev(change))
print(q)
q <- autoplot(sp_elev(change, elev))
q <- autoplot(sp_elev(change, elevation))
q <- autoplot(sp_elev(change))
print(q)
devtools::update_packages("fgeo")
install.packages("Rcpp")
devtools::update_packages("fgeo")
install.packages("rlang")
devtools::update_packages("fgeo")
scbi.stem2 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/SCBI-ForestGEO-Data/tree_main_census/data/census-csv-files/scbi.stem2.csv", stringsAsFactors=FALSE)
alive <- scbi.stem2[scbi.stem2$DFstatus == "alive", ]
library(fgeo)
change <- alive[alive$sp %in% "acne", ]
q <- autoplot(sp_elev(change))
print(q)
q <- autoplot(sp_elev(change, elevation))
print(q)
pdf("test.pdf", width=10)
for (i in seq(along=alive$sp)){
test <- alive$sp[[i]]
change <- alive[alive$sp %in% test, ]
q <- autoplot(sp_elev(change, elevation))
print(q)
}
dev.off()
q <- autoplot_by_species(sp_elev(alive, elevation))
View(q)
View(q$acne)
print(q$acne)
print(q$acsp)
q <- autoplot(sp_elev(alive, elevation))
print(q)
change <- alive[alive$sp %in% "acne", ]
q <- autoplot(sp_elev(change, elevation))
autoplot(sp_elev(change, elevation))
scbi.stem2 <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/SCBI-ForestGEO-Data/tree_main_census/data/census-csv-files/scbi.stem2.csv", stringsAsFactors=FALSE)
alive <- scbi.stem2[scbi.stem2$DFstatus == "alive" & scbi.stem2$DBH>0, ]
library(fgeo)
change <- alive[alive$sp %in% "acne", ]
autoplot(sp_elev(change, elevation))
head(elevation)
head(elevation$col)
q <- autoplot(sp_elev(alive, elevation))
print(q)
q <- autoplot(sp_elev(alive, elevation), facet=FALSE)
print(q)
i=1
test <- alive$sp[[i]]
View(alive)
test <- alive$sp[[i]]
i=2
test <- unique(alive$sp)[[i]]
pdf("test.pdf", width=10)
for (i in seq(along=unique(alive$sp))){
test <- unique(alive$sp)[[i]]
change <- alive[alive$sp %in% test, ]
q <- autoplot(sp_elev(change, elevation))
print(q)
}
dev.off()
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data")
dirs <- dir("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data", pattern="_201[0-8]*.csv")
dendro_trees <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/dendro_trees.csv", stringsAsFactors=FALSE)
survey <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/survey_numbers_per_year.csv")
for (k in seq(along=dirs)){
path <- dirs[[k]]
file <- read.csv(path, stringsAsFactors = FALSE)
for (i in seq(along=survey$year[1:9])){
year <- survey$year[[i]]
if (k==i){
#n.surveys
survey$n.surveys <- ifelse(survey$year %in% survey$year[[i]], length(unique(file$survey.ID)), survey$n.surveys)
#__.all
all_bi <- dendro_trees[!dendro_trees$dendro.start.year > year, ]
survey$biannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_bi$stemID)), survey$biannual.all)
all_intra <- all_bi[all_bi$intraannual == 1, ]
survey$intraannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_intra$stemID)), survey$intraannual.all)
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$survey.ID == max(file$survey.ID), ]
#because 2013 new plants added in middle of season
} else {
alive <- file[file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
}
survey$biannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive$stemID)), survey$biannual.live)
alive_intra <- file[file$intraannual == 1 & file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
survey$intraannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive_intra$stemID)), survey$intraannual.live)
#___.dead
dead <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID), ]
survey$biannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead$stemID)), survey$biannual.dead)
dead_intra <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID) & file$intraannual == 1, ]
survey$intraannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead_intra$stemID)), survey$intraannual.dead)
#___.added
new <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]], ]
survey$biannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new$stemID)), survey$biannual.added)
new_intra <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]] & dendro_trees$intraannual == 1, ]
survey$intraannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new_intra$stemID)), survey$intraannual.added)
}
View(survey)
i=2
k=2
path <- dirs[[k]]
file <- read.csv(path, stringsAsFactors = FALSE)
year <- survey$year[[i]]
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$survey.ID == max(file$survey.ID), ]
#because 2013 new plants added in middle of season
} else {
alive <- file[file$survey.ID == min(file$survey.ID), ]
}
for (k in seq(along=dirs)){
path <- dirs[[k]]
file <- read.csv(path, stringsAsFactors = FALSE)
for (i in seq(along=survey$year[1:9])){
year <- survey$year[[i]]
if (k==i){
#n.surveys
survey$n.surveys <- ifelse(survey$year %in% survey$year[[i]], length(unique(file$survey.ID)), survey$n.surveys)
#__.all
all_bi <- dendro_trees[!dendro_trees$dendro.start.year > year, ]
survey$biannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_bi$stemID)), survey$biannual.all)
all_intra <- all_bi[all_bi$intraannual == 1, ]
survey$intraannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_intra$stemID)), survey$intraannual.all)
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$survey.ID == max(file$survey.ID), ]
#because 2013 new plants added in middle of season
} else {
alive <- file[file$survey.ID == min(file$survey.ID), ]
}
survey$biannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive$stemID)), survey$biannual.live)
alive_intra <- file[file$intraannual == 1 & file$status == "alive" & file$survey.ID == min(file$survey.ID), ]
survey$intraannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive_intra$stemID)), survey$intraannual.live)
#___.dead
dead <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID), ]
survey$biannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead$stemID)), survey$biannual.dead)
dead_intra <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID) & file$intraannual == 1, ]
survey$intraannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead_intra$stemID)), survey$intraannual.dead)
#___.added
new <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]], ]
survey$biannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new$stemID)), survey$biannual.added)
new_intra <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]] & dendro_trees$intraannual == 1, ]
survey$intraannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new_intra$stemID)), survey$intraannual.added)
}
View(survey)
for (k in seq(along=dirs)){
path <- dirs[[k]]
file <- read.csv(path, stringsAsFactors = FALSE)
for (i in seq(along=survey$year[1:9])){
year <- survey$year[[i]]
if (k==i){
#n.surveys
survey$n.surveys <- ifelse(survey$year %in% survey$year[[i]], length(unique(file$survey.ID)), survey$n.surveys)
#__.all
all_bi <- dendro_trees[!dendro_trees$dendro.start.year > year, ]
survey$biannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_bi$stemID)), survey$biannual.all)
all_intra <- all_bi[all_bi$intraannual == 1, ]
survey$intraannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_intra$stemID)), survey$intraannual.all)
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$survey.ID == max(file$survey.ID), ]
#because 2013 new plants added in middle of season
} else {
alive <- file[file$survey.ID == min(file$survey.ID), ]
}
survey$biannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive$stemID)), survey$biannual.live)
alive_intra <- file[file$intraannual == 1 & file$survey.ID == min(file$survey.ID), ]
survey$intraannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive_intra$stemID)), survey$intraannual.live)
#___.dead
dead <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID), ]
survey$biannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead$stemID)), survey$biannual.dead)
dead_intra <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID) & file$intraannual == 1, ]
survey$intraannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead_intra$stemID)), survey$intraannual.dead)
#___.added
new <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]], ]
survey$biannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new$stemID)), survey$biannual.added)
new_intra <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]] & dendro_trees$intraannual == 1, ]
survey$intraannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new_intra$stemID)), survey$intraannual.added)
}
View(survey)
for (k in seq(along=dirs)){
path <- dirs[[k]]
file <- read.csv(path, stringsAsFactors = FALSE)
for (i in seq(along=survey$year[1:9])){
year <- survey$year[[i]]
if (k==i){
#n.surveys
survey$n.surveys <- ifelse(survey$year %in% survey$year[[i]], length(unique(file$survey.ID)), survey$n.surveys)
#__.all
all_bi <- dendro_trees[!dendro_trees$dendro.start.year > year, ]
survey$biannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_bi$stemID)), survey$biannual.all)
all_intra <- all_bi[all_bi$intraannual == 1, ]
survey$intraannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_intra$stemID)), survey$intraannual.all)
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$survey.ID == max(file$survey.ID), ]
#because 2013 new plants added in middle of season
} else {
alive <- file[file$survey.ID == min(file$survey.ID), ]
}
survey$biannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive$stemID)), survey$biannual.live)
if (year == 2013){
alive_intra <- file[file$intraannual == 1, file$survey.ID == max(file$survey.ID), ]
#because 2013 new plants added in middle of season
} else {
alive_intra <- file[file$intraannual == 1, file$survey.ID == min(file$survey.ID), ]
}
survey$intraannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive_intra$stemID)), survey$intraannual.live)
#___.dead
dead <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID), ]
survey$biannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead$stemID)), survey$biannual.dead)
dead_intra <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID) & file$intraannual == 1, ]
survey$intraannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead_intra$stemID)), survey$intraannual.dead)
#___.added
new <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]], ]
survey$biannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new$stemID)), survey$biannual.added)
new_intra <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]] & dendro_trees$intraannual == 1, ]
survey$intraannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new_intra$stemID)), survey$intraannual.added)
}
for (k in seq(along=dirs)){
path <- dirs[[k]]
file <- read.csv(path, stringsAsFactors = FALSE)
for (i in seq(along=survey$year[1:9])){
year <- survey$year[[i]]
if (k==i){
#n.surveys
survey$n.surveys <- ifelse(survey$year %in% survey$year[[i]], length(unique(file$survey.ID)), survey$n.surveys)
#__.all
all_bi <- dendro_trees[!dendro_trees$dendro.start.year > year, ]
survey$biannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_bi$stemID)), survey$biannual.all)
all_intra <- all_bi[all_bi$intraannual == 1, ]
survey$intraannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_intra$stemID)), survey$intraannual.all)
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$survey.ID == max(file$survey.ID), ]
#because 2013 new plants added in middle of season
} else {
alive <- file[file$survey.ID == min(file$survey.ID), ]
}
survey$biannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive$stemID)), survey$biannual.live)
if (year == 2013){
alive_intra <- file[file$intraannual == 1 & file$survey.ID == max(file$survey.ID), ]
#because 2013 new plants added in middle of season
} else {
alive_intra <- file[file$intraannual == 1 & file$survey.ID == min(file$survey.ID), ]
}
survey$intraannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive_intra$stemID)), survey$intraannual.live)
#___.dead
dead <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID), ]
survey$biannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead$stemID)), survey$biannual.dead)
dead_intra <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID) & file$intraannual == 1, ]
survey$intraannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead_intra$stemID)), survey$intraannual.dead)
#___.added
new <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]], ]
survey$biannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new$stemID)), survey$biannual.added)
new_intra <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]] & dendro_trees$intraannual == 1, ]
survey$intraannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new_intra$stemID)), survey$intraannual.added)
}
View(survey)
library(fgeo)
?auotplot
?autoplot
setwd("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data")
dirs <- dir("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data", pattern="_201[0-8]*.csv")
dendro_trees <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/dendro_trees.csv", stringsAsFactors=FALSE)
survey <- read.csv("C:/Users/mcgregori/Dropbox (Smithsonian)/Github_Ian/Dendrobands/data/survey_numbers_per_year.csv")
for (k in seq(along=dirs)){
path <- dirs[[k]]
file <- read.csv(path, stringsAsFactors = FALSE)
for (i in seq(along=survey$year[1:9])){
year <- survey$year[[i]]
if (k==i){
#n.surveys
survey$n.surveys <- ifelse(survey$year %in% survey$year[[i]], length(unique(file$survey.ID)), survey$n.surveys)
#__.all
all_bi <- dendro_trees[!dendro_trees$dendro.start.year > year, ]
survey$biannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_bi$stemID)), survey$biannual.all)
all_intra <- all_bi[all_bi$intraannual == 1, ]
survey$intraannual.all <- ifelse(survey$year %in% survey$year[[i]], length(unique(all_intra$stemID)), survey$intraannual.all)
#___.live
#the min is here because we're interested in seeing the survey numbers as they were at when the growing season started. The only reason to use the max survey.ID is for calculating dead trees and additions.
if (year == 2013){
alive <- file[file$survey.ID == max(file$survey.ID), ]
#because 2013 new plants added in middle of season
} else {
alive <- file[file$survey.ID == min(file$survey.ID), ]
}
survey$biannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive$stemID)), survey$biannual.live)
if (year == 2013){
alive_intra <- file[file$intraannual == 1 & file$survey.ID == max(file$survey.ID), ]
#because 2013 new plants added in middle of season
} else {
alive_intra <- file[file$intraannual == 1 & file$survey.ID == min(file$survey.ID), ]
}
survey$intraannual.live <- ifelse(survey$year %in% survey$year[[i]], length(unique(alive_intra$stemID)), survey$intraannual.live)
#___.dead
dead <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID), ]
survey$biannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead$stemID)), survey$biannual.dead)
dead_intra <- file[file$status == "dead" & file$survey.ID == max(file$survey.ID) & file$intraannual == 1, ]
survey$intraannual.dead <- ifelse(survey$year %in% survey$year[[i]], length(unique(dead_intra$stemID)), survey$intraannual.dead)
#___.added
new <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]], ]
survey$biannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new$stemID)), survey$biannual.added)
new_intra <- dendro_trees[dendro_trees$dendro.start.year %in% survey$year[[i]] & dendro_trees$intraannual == 1, ]
survey$intraannual.added <- ifelse(survey$year %in% survey$year[[i]],length(unique(new_intra$stemID)), survey$intraannual.added)
}
View(survey)
install.packages("here")
library(here)
?here
i=8
k=8
path <- dirs[[k]]
file <- read.csv(path, stringsAsFactors = FALSE)
year <- survey$year[[i]]
alive <- file[file$survey.ID == min(file$survey.ID), ]
length(unique(alive$stemID))
